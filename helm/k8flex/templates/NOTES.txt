ğŸ‰ K8flex AI Debug Agent has been deployed!

ğŸ“Š Release Information:
  Name:      {{ .Release.Name }}
  Namespace: {{ .Release.Namespace }}
  Version:   {{ .Chart.Version }}

ğŸ” Get the application status:
  kubectl get pods -n {{ .Release.Namespace }} -l "app.kubernetes.io/name={{ include "k8flex.name" . }},app.kubernetes.io/instance={{ .Release.Name }}"

ğŸ“ View logs:
  kubectl logs -n {{ .Release.Namespace }} deployment/{{ include "k8flex.fullname" . }} -f

ğŸŒ Service endpoint (internal):
  http://{{ include "k8flex.fullname" . }}.{{ .Release.Namespace }}.svc.cluster.local:{{ .Values.service.port }}/webhook

âš™ï¸  Configuration:
  - LLM Provider: {{ .Values.config.llm.provider | default "ollama" }}
{{- if eq (.Values.config.llm.provider | default "ollama") "ollama" }}
  - Ollama URL: {{ .Values.config.ollama.url }}
  - Ollama Model: {{ .Values.config.ollama.model }}
{{- end }}
{{- if .Values.adapters.enabled }}
  - Enabled Adapters: {{ .Values.adapters.enabled }}
{{- else }}
  - Enabled Adapters: All (alertmanager, pagerduty, grafana, datadog, opsgenie, victorops, newrelic)
{{- end }}
{{- if or .Values.slack.botToken .Values.slack.webhookUrl }}
  - Slack: âœ… Enabled
  {{- if .Values.slack.botToken }}
  - Threading: âœ… Supported (Bot token)
  {{- else }}
  - Threading: âš ï¸  Not supported (Webhook only)
  {{- end }}
{{- else }}
  - Slack: âš ï¸  Not configured
{{- end }}
{{- if .Values.knowledgeBase.enabled }}
  - Knowledge Base: âœ… Enabled
{{- end }}

ğŸ“š Next Steps:

{{- if not (or .Values.slack.botToken .Values.slack.webhookUrl) }}

1. Configure Slack Integration:
   
   For threading support (recommended):
   helm upgrade {{ .Release.Name }} ./helm/k8flex \
     --namespace {{ .Release.Namespace }} \
     --set slack.botToken="xoxb-YOUR-BOT-TOKEN" \
     --set slack.channelId="C01234567890"

   OR use webhook (no threading):
   helm upgrade {{ .Release.Name }} ./helm/k8flex \
     --namespace {{ .Release.Namespace }} \
     --set slack.webhookUrl="https://hooks.slack.com/services/..."

{{- end }}

2. Configure Your Alerting System(s):

   K8flex webhook endpoint: http://{{ include "k8flex.fullname" . }}.{{ .Release.Namespace }}.svc.cluster.local:{{ .Values.service.port }}/webhook

   ğŸ“Œ Alertmanager:
   receivers:
     - name: 'k8flex-ai-debug'
       webhook_configs:
         - url: 'http://{{ include "k8flex.fullname" . }}.{{ .Release.Namespace }}.svc.cluster.local:{{ .Values.service.port }}/webhook'

   ğŸ“Œ PagerDuty: Add Generic Webhook (v3) integration with above URL
   ğŸ“Œ Grafana: Add webhook contact point with above URL  
   ğŸ“Œ Datadog: Create webhook integration with above URL
   ğŸ“Œ Opsgenie: Add outgoing webhook with above URL
   ğŸ“Œ VictorOps: Add outgoing webhook with above URL
   ğŸ“Œ New Relic: Add webhook notification channel with above URL

   See docs/INTEGRATION.md for detailed setup instructions.

{{- if not .Values.adapters.enabled }}

3. Optional: Limit Enabled Adapters:
   
   Currently all alerting systems are enabled. To restrict which systems k8flex accepts:
   
   helm upgrade {{ .Release.Name }} ./helm/k8flex \
     --namespace {{ .Release.Namespace }} \
     --set adapters.enabled="alertmanager,pagerduty,grafana"

{{- end }}

{{- if eq (.Values.config.llm.provider | default "ollama") "ollama" }}

4. Ensure Ollama is deployed:
   kubectl get service ollama -n ollama

{{- end }}

5. Test the webhook:
   
   kubectl run test-webhook --rm -i --restart=Never --image=curlimages/curl -- \
     curl -X POST http://{{ include "k8flex.fullname" . }}.{{ .Release.Namespace }}.svc.cluster.local:{{ .Values.service.port }}/webhook \
     -H "Content-Type: application/json" \
     -d @- << 'EOF'
   {"alerts":[{"status":"firing","labels":{"alertname":"Test","namespace":"default","pod":"test-pod"},"annotations":{"summary":"Test alert"}}]}
   EOF

ğŸ“– Documentation:
   - README: ../../README.md
   - Adapter Configuration: ../../docs/ADAPTER_CONFIGURATION.md
   - Integration Guide: ../../docs/INTEGRATION.md
   - Webhook Examples: ../../examples/README.md
   - Slack Setup: ../../docs/SLACK_SETUP.md

ğŸ› Troubleshooting:
   kubectl logs -n {{ .Release.Namespace }} deployment/{{ include "k8flex.fullname" . }}
   kubectl describe pod -n {{ .Release.Namespace }} -l "app.kubernetes.io/name={{ include "k8flex.name" . }}"

Happy debugging! ğŸš€
